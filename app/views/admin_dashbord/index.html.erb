<style>
  body {
    font-family: 'Segoe UI', sans-serif;
  }
</style>
</head>

<body class="bg-black text-blue-300 ">
  <div class="flex flex-col md:flex-row mt-16 h-screen overflow-hidden">
    
    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-gray-900 text-white flex-shrink-0 p-4 space-y-6 overflow-y-auto md:overflow-visible h-auto md:h-full">
      <div class="text-2xl font-bold text-blue-300 mb-4 flex items-center">
        <i class="fas fa-shield-alt mr-2"></i> Admin Panel
      </div>
      <nav class="flex flex-col space-y-4 text-sm">
        <%=link_to root_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-tachometer-alt"></i> Dashboard
        <% end %>

        <%= link_to profile_index_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
            <i class="fas fa-user mr-2"></i>My Profile
        <% end %>
        <%= link_to admin_index_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-users"></i> Manage Staff & Employees
        <% end %>
        
        <%= link_to admin_users_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-users-cog"></i> All Users
        <% end %>
        
        <%= link_to top_earners_admin_users_path, class: "flex items-center gap-3 hover:text-yellow-400 transition" do %>
          <i class="fas fa-trophy"></i> Top Earners
        <% end %>

        <%= link_to  new_learn_and_earn_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-graduation-cap mr-2"></i> Learn & Earn
        <% end %>

        <%= link_to   admin_social_tasks_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-tasks mr-2"></i> Social Tasks
        <% end %>

        <%= link_to   admin_social_task_proofs_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-graduation-cap mr-2"></i> Aprove Social Task
        <% end %>

        <%= link_to  new_task_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
         <i class="fa-solid fa-list-check"></i> Add Task
        <% end %>
        <%= link_to new_link_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-link"></i> Create Short Link
        <% end %>

        <%= link_to  user_tasks_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
         <i class="fa-solid fa-list-check"></i> User Submit Task
        <% end %>

        <%= link_to withdrawals_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fa fa-check" aria-hidden="true"></i> Widthdrawal Requests
        <% end %>


        <%= link_to new_admin_notification_path,class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-bell "></i> Send Notifications
        <% end %>

        <%= link_to admin_referrals_path, class: "flex items-center gap-3 hover:text-blue-400 transition #{current_page?(admin_referrals_path) ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-700'}" do %>
          <i class="fas fa-user-friends"></i><span> Referrals</span>
<% end %>

        <%= link_to   edit_user_registration_path, class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-cogs"></i> Settings
        <% end %>

        <%= link_to  contact_messages_path,class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-envelope"></i> Contact Messages
        <% end %>
       
        <%=link_to reports_index_path,class: "flex items-center gap-3 hover:text-blue-400 transition" do %>
          <i class="fas fa-chart-bar"></i> Reports
        <% end %>

        <%= link_to destroy_user_session_path, method: :delete, data: {turbo_method: :delete, turbo_confirm: "Are You Sure..!"}, class: "flex items-center gap-3 hover:text-red-400 transition" do %>
          <i class="fas fa-sign-out-alt"></i> Logout
        <% end %>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="flex-1 flex flex-col overflow-hidden">
      
      <!-- Header -->
      <header class="bg-gray-800 text-white p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 sm:gap-4 sticky top-0 z-30 shadow">
        <h1 class="text-xl font-semibold">Dashboard Overview</h1>
        <div class="flex items-center gap-2 text-sm">
          <i class="fas fa-bell text-blue-300"></i>
        <span>Welcome
        <%= if current_user.admin?
        current_user.name.present? ? current_user.name : current_user.email.split("@").first.capitalize
        end %>
      </span>

        </div>
      </header>

      <!-- Dashboard Cards -->
      <section class="flex-1 overflow-y-auto p-4 sm:p-6 space-y-6">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-user mr-2"></i>Total Users
            </h2>
            <p class="text-white text-3xl"><%= @total_user.count %></p>
          </div>

          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-chart-line mr-2"></i>Total Traffic
            </h2>
            <p class="text-white text-3xl"><%= @total_click.count %></p>
          </div>

           <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-chart-line mr-2"></i>Total User Task
            </h2>
            <p class="text-white text-3xl"><%=  @user_task.count %></p>
          </div>

          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-chart-line mr-2"></i>Total Referral Users
            </h2>
            <p class="text-white text-3xl"><%=  @referrals.count %></p>
          </div>

          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-link mr-2"></i>Total Links
            </h2>
            <p class="text-white text-3xl"><%= @total_link.count %></p>
          </div>
        </div>

        <!-- User Balance Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-wallet mr-2"></i>Total Balance
            </h2>
            <p class="text-white text-3xl">$<%= number_with_precision(@total_balance, precision: 2) %></p>
          </div>
          
          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-calculator mr-2"></i>Average Balance
            </h2>
            <p class="text-white text-3xl">$<%= number_with_precision(@avg_balance, precision: 2) %></p>
          </div>
          
          <div class="bg-gray-900 p-6 rounded-lg shadow-lg hover:shadow-blue-400 transition">
            <h2 class="text-xl font-semibold text-blue-300 mb-2">
              <i class="fas fa-users mr-2"></i>Active Users
            </h2>
            <p class="text-white text-3xl"><%= @total_user.count %></p>
          </div>
        </div>
        
        <!-- Top Users by Balance -->
        <div class="bg-gray-900 mt-6 p-6 rounded-lg shadow-lg overflow-x-auto">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-white flex items-center">
              <i class="fas fa-trophy mr-2"></i>Top Users by Balance
            </h2>
            <%= link_to top_earners_admin_users_path, class: "bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white px-4 py-2 rounded-lg font-semibold transition flex items-center gap-2 shadow-lg" do %>
              <i class="fas fa-trophy"></i>
              View All Top Earners
            <% end %>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-700">
              <thead class="bg-gray-800">
                <tr>
                  <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">User</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Email</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Balance</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Role</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Status</th>
                  <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-700">
                <% @users_with_balance.each do |user| %>
                  <tr>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                      <%= user.name.present? ? user.name : 'N/A' %>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                      <%= user.email %>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                      $<%= number_with_precision(user.balance, precision: 2) %>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                      <span class="px-2 py-1 rounded text-xs font-medium
                        <% if user.admin? %>
                          bg-purple-600 text-white
                        <% elsif user.staff? %>
                          bg-blue-600 text-white
                        <% else %>
                          bg-green-600 text-white
                        <% end %>
                      ">
                        <%= user.role.titleize %>
                      </span>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                      <% if user.suspended? %>
                        <span class="px-2 py-1 rounded text-xs font-medium bg-red-600 text-white">Suspended</span>
                      <% else %>
                        <span class="px-2 py-1 rounded text-xs font-medium bg-green-600 text-white">Active</span>
                      <% end %>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap text-sm">
                      <%= form_with model: [user], url: update_balance_admin_path(user), method: :patch, local: true, class: "flex items-center space-x-2" do |f| %>
                        <%= f.number_field :balance, value: user.balance, step: 0.01, class: "w-24 px-2 py-1 text-white rounded text-sm" %>
                        <%= f.submit 'Update', class: "px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm" %>
                      <% end %>
                      <%= link_to 'Manage', admin_user_path(user), class: "ml-2 px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm" %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="bg-gray-900 mt-6 p-6 rounded-lg shadow-lg">
          <h2 class="text-xl font-semibold text-blue-300 mb-4">
            <i class="fas fa-bolt mr-2"></i>Quick Actions
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
            <%= link_to admin_index_path, class: "px-4 py-3 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition text-center" do %>
              <i class="fas fa-users mr-2"></i> Manage All Users
            <% end %>
            <%= link_to top_earners_admin_users_path, class: "px-4 py-3 bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white rounded-lg transition text-center font-semibold shadow-lg" do %>
              <i class="fas fa-trophy mr-2"></i> Top Earners
            <% end %>
            <%= link_to admin_referrals_path, class: "px-4 py-3 bg-green-700 text-white rounded-lg hover:bg-green-800 transition text-center" do %>
              <i class="fas fa-user-friends mr-2"></i> View Referrals
            <% end %>
            <%= link_to admin_social_task_proofs_path, class: "px-4 py-3 bg-purple-700 text-white rounded-lg hover:bg-purple-800 transition text-center" do %>
              <i class="fas fa-tasks mr-2"></i> Review Proofs
            <% end %>
            <%= link_to new_admin_social_task_path, class: "px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition text-center" do %>
              <i class="fas fa-plus-circle mr-2"></i> Create Social Task
            <% end %>
          </div>
        </div>
        
        <!-- Recent Users List -->
        <div class="bg-gray-900 mt-6 p-6 rounded-lg shadow-lg overflow-x-auto">
          <h2 class="text-xl font-semibold text-blue-300 mb-4">
            <i class="fas fa-clock mr-2"></i> Recently Registered Users
          </h2>
          <ul class="divide-y divide-gray-700 text-sm">
            <% @recent_users.each do |user| %>
              <li class="py-3 flex flex-col sm:flex-row sm:justify-between sm:items-center">
                <span class="flex items-center gap-2">
                  <i class="fas fa-user-circle text-blue-400"></i>
                  <%= user.email %>
                </span>
                <span class="text-gray-400 text-xs sm:text-sm mt-1 sm:mt-0">
                  <%= user.created_at.strftime("%b %d, %Y %I:%M %p") %>
                </span>
              </li>
            <% end %>
          </ul>
        </div>
        
        <!-- Pending Learn & Earn Approvals -->
        <% if @pending_learn_and_earns.any? %>
          <div class="bg-gray-900 mt-6 p-6 rounded-lg shadow-lg overflow-x-auto">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-semibold text-blue-300">
                <i class="fas fa-graduation-cap mr-2"></i>Pending Learn & Earn Approvals
              </h2>
              <%= link_to "View All", learn_and_earns_path, class: "text-blue-400 hover:text-blue-300 text-sm" %>
            </div>
            
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-700">
                <thead class="bg-gray-800">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">User</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Referral Link</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Social Post</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Submitted</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Actions</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-700">
                  <% @pending_learn_and_earns.each do |entry| %>
                    <tr class="hover:bg-gray-800 transition">
                      <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                        <%= entry.user.email %>
                      </td>
                      <td class="px-4 py-3 text-sm text-white max-w-xs truncate">
                        <%= entry.link %>
                      </td>
                      <td class="px-4 py-3 text-sm text-white max-w-xs truncate">
                        <%= entry.social_post %>
                      </td>
                      <td class="px-4 py-3 whitespace-nowrap text-sm text-white">
                        <%= entry.created_at.strftime("%b %d, %Y") %>
                      </td>
                      <td class="px-4 py-3 whitespace-nowrap text-sm">
                        <div class="flex space-x-2">
                          <%= button_to "Approve", approve_learn_and_earn_path(entry), 
                              method: :post, 
                              class: "px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-xs" %>
                          <%= button_to "Reject", reject_learn_and_earn_path(entry), 
                              method: :post, 
                              class: "px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs" %>
                          <%= link_to "View", learn_and_earn_path(entry), 
                              class: "px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-xs" %>
                        </div>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        <% end %>
        
        <!-- Social Tasks Overview -->
        <div class="bg-gray-900 mt-6 p-6 rounded-lg shadow-lg">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-blue-300">
              <i class="fas fa-tasks mr-2"></i>Social Tasks Overview
            </h2>
            <div class="flex space-x-2">
              <%= link_to "View All", admin_social_tasks_path, class: "text-blue-400 hover:text-blue-300 text-sm" %>
              <%= link_to "Create New", new_admin_social_task_path, class: "bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 rounded text-sm" %>
            </div>
          </div>
          
          <% if @social_tasks.any? %>
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-700">
                <thead class="bg-gray-800">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Task Name</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Proofs</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Created</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-black uppercase tracking-wider">Actions</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-700">
                  <% @social_tasks.each do |task| %>
                    <tr class="hover:bg-gray-800 transition">
                      <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-white">
                        <%= task.name %>
                      </td>
                      <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-300">
                        <%= task.social_task_proofs.count %> submissions
                      </td>
                      <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-300">
                        <%= task.created_at.strftime("%b %d, %Y") %>
                      </td>
                      <td class="px-4 py-3 whitespace-nowrap text-sm">
                        <div class="flex space-x-2">
                          <%= link_to "View", admin_social_task_proofs_path, class: "text-blue-400 hover:text-blue-300 text-xs" %>
                          <%= link_to "Edit", edit_admin_social_task_path(task), class: "text-green-400 hover:text-green-300 text-xs" %>
                        </div>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          <% else %>
            <div class="text-center py-8">
              <div class="text-4xl mb-3">üìù</div>
              <p class="text-gray-400">No social tasks created yet.</p>
              <%= link_to "Create First Social Task", new_admin_social_task_path, class: "mt-4 inline-block bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded transition" %>
            </div>
          <% end %>
        </div>
      </section>
    </main>
  </div>
</body>

